<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>Chaters ‚Äî —á–∞—Ç</title>
    
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
</head>
<body class="chat-body">
    <div class="chat-container">
        <!-- ===== –®–ê–ü–ö–ê –ß–ê–¢–ê ‚Äî –¢–û–õ–¨–ö–û ABSOLUTE ===== -->
        <div class="chat-header" id="chatHeader">
            <!-- –°–¢–†–ï–õ–ö–ê ‚Äî –ñ–Å–°–¢–ö–û –°–õ–ï–í–ê -->
            <button class="back-button" aria-label="–ù–∞–∑–∞–¥">‚Üê</button>
            
            <!-- –ù–ê–ó–í–ê–ù–ò–ï ‚Äî –ñ–Å–°–¢–ö–û –ü–û –¶–ï–ù–¢–†–£ -->
            <div class="chat-info">
                <span class="chat-name" id="chatName">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                <span class="chat-members-count" id="chatMembersCount">0 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</span>
            </div>
            
            <!-- –ö–û–õ–û–ö–û–õ–¨–ß–ò–ö ‚Äî –ñ–Å–°–¢–ö–û –°–ü–†–ê–í–ê -->
            <button id="notificationButton" class="notification-button" aria-label="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—ã–∫–ª—é—á–µ–Ω—ã">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18 8C18 6.4087 17.3679 4.88258 16.2426 3.75736C15.1174 2.63214 13.5913 2 12 2C10.4087 2 8.88258 2.63214 7.75736 3.75736C6.63214 4.88258 6 6.4087 6 8C6 11.5 5 13 4 14H20C19 13 18 11.5 18 8Z" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    <path d="M12 22C13.1 22 14 21.1 14 20H10C10 21.1 10.9 22 12 22Z" fill="currentColor"/>
                    <path class="bell-off" d="M4 4L20 20" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                </svg>
            </button>
        </div>

        <!-- ===== –ú–ï–ù–Æ –ß–ê–¢–ê ===== -->
        <div id="chatMenu" class="chat-menu-overlay hidden">
            <div class="chat-menu">
                <div class="chat-menu-header">
                    <span id="menuChatName">–ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞</span>
                    <span id="menuChatId" class="menu-chat-id">#—á–∞—Ç</span>
                    <button class="close-menu">√ó</button>
                </div>

                <div id="creatorSettings" class="menu-section hidden">
                    <div class="menu-section-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞</div>
                    <div class="menu-item edit-item" id="editChatNameItem">
                        <span class="menu-item-label">–ù–∞–∑–≤–∞–Ω–∏–µ</span>
                        <span id="currentChatName" class="menu-item-value">–ù–∞–∑–≤–∞–Ω–∏–µ</span>
                        <span class="menu-item-action">‚úé</span>
                    </div>
                    <div class="menu-item edit-item" id="editChatIdItem">
                        <span class="menu-item-label">ID —á–∞—Ç–∞</span>
                        <span id="currentChatId" class="menu-item-value">#—á–∞—Ç</span>
                        <span class="menu-item-action">‚úé</span>
                    </div>
                </div>

                <div class="menu-section">
                    <div class="menu-section-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</div>
                    <div id="deleteChatItem" class="menu-item danger hidden">
                        <span class="menu-item-label">–£–¥–∞–ª–∏—Ç—å —á–∞—Ç</span>
                        <span class="menu-item-action">üóëÔ∏è</span>
                    </div>
                    <div id="leaveChatItem" class="menu-item danger">
                        <span class="menu-item-label">–í—ã–π—Ç–∏ –∏–∑ —á–∞—Ç–∞</span>
                        <span class="menu-item-action">üö™</span>
                    </div>
                </div>

                <div class="menu-section">
                    <div class="menu-section-title">
                        –£—á–∞—Å—Ç–Ω–∏–∫–∏
                        <span id="membersCountBadge">0</span>
                    </div>
                    <div id="membersList" class="members-list"></div>
                </div>
            </div>
        </div>

        <!-- ===== –ú–û–î–ê–õ–ö–ò ===== -->
        <div id="editNameModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ</h3>
                    <button class="close">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <input type="text" id="editChatNameInput" placeholder="–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" maxlength="50">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary cancel-btn">–û—Ç–º–µ–Ω–∞</button>
                    <button id="saveChatNameBtn" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <div id="editIdModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–ò–∑–º–µ–Ω–∏—Ç—å ID —á–∞—Ç–∞</h3>
                    <button class="close">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <input type="text" id="editChatIdInput" placeholder="#–Ω–æ–≤—ã–π-id" maxlength="30">
                        <small class="hint">–¢–æ–ª—å–∫–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ —Ç–æ—á–∫–∏</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary cancel-btn">–û—Ç–º–µ–Ω–∞</button>
                    <button id="saveChatIdBtn" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- ===== –°–û–û–ë–©–ï–ù–ò–Ø ===== -->
        <div id="messagesContainer" class="messages-container">
            <div id="messagesLoader" class="messages-loader hidden">
                <div class="spinner-small"></div>
            </div>
        </div>

        <div id="typingIndicator" class="typing-indicator hidden"></div>

        <div id="emptyChat" class="empty-chat hidden">
            <span class="empty-icon">üí¨</span>
            <h3>–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
            <p>–ù–∞–ø–∏—à–∏—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</p>
        </div>

        <!-- ===== –ò–ù–ü–£–¢ ===== -->
        <div class="message-input-container">
            <button id="attachButton" class="attach-button" aria-label="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">+</button>
            <div class="input-wrapper" id="messageInputWrapper">
                <textarea id="messageInput" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ" rows="1" aria-label="–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è"></textarea>
            </div>
            <button id="sendButton" class="send-button">‚Üí</button>
            <button id="voiceButton" class="voice-button hidden">üé§</button>
        </div>

        <input type="file" id="fileInput" class="hidden" accept="image/*,audio/*,video/*,.pdf,.doc,.docx,.txt" aria-label="–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª">
    </div>

    <!-- ===== –ü–†–ï–î–ü–†–û–°–ú–û–¢–† ===== -->
    <div id="imagePreviewModal" class="modal hidden">
        <div class="modal-content" style="background: none; border: none;">
            <img id="previewImage" src="" alt="–ü—Ä–µ–≤—å—é" style="max-width: 100%; max-height: 80vh; border-radius: 12px;">
            <button class="close-modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/chat.js"></script>
</body>
</html>
