<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>Chaters ‚Äî —á–∞—Ç</title>
    
    <link rel="stylesheet" href="./css/style.css">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
</head>
<body class="chat-body">
    <div class="chat-container">
        <div class="chat-header">
            <div class="chat-header-left">
                <button class="back-button" onclick="window.location.href='/dashboard.html'" aria-label="–ù–∞–∑–∞–¥">‚Üê</button>
                <div class="chat-info">
                    <span class="chat-name">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    <span class="chat-id">#</span>
                </div>
            </div>
            <div class="chat-header-right">
                <button class="menu-button" aria-label="–ú–µ–Ω—é">‚ãÆ</button>
            </div>
        </div>

        <div id="chatMenu" class="chat-menu hidden">
            <div class="menu-item" onclick="window.showMembers()">–£—á–∞—Å—Ç–Ω–∏–∫–∏</div>
            <div class="menu-item" onclick="window.showSettings()">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            <div class="menu-item" onclick="window.leaveChat()">–ü–æ–∫–∏–Ω—É—Ç—å —á–∞—Ç</div>
        </div>

        <div id="typingIndicator" class="typing-indicator hidden"></div>

        <div id="messagesContainer" class="messages-container">
            <div id="messagesLoader" class="messages-loader hidden">
                <div class="spinner-small"></div>
            </div>
        </div>

        <div id="emptyChat" class="empty-chat hidden">
            <span class="empty-icon">üí¨</span>
            <h3>–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</h3>
            <p>–ù–∞–ø–∏—à–∏—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</p>
        </div>

        <div class="message-input-container">
            <button id="attachButton" class="attach-button" aria-label="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª">+</button>
            <div class="input-wrapper">
                <label for="messageInput" class="visually-hidden">–°–æ–æ–±—â–µ–Ω–∏–µ</label>
                <textarea 
                    id="messageInput" 
                    placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ" 
                    rows="1"
                    aria-label="–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è"
                ></textarea>
                <button id="voiceButton" class="voice-button" aria-label="–ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ">üé§</button>
            </div>
            <button id="sendButton" class="send-button" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">‚Üí</button>
        </div>

        <input type="file" id="fileInput" class="hidden" accept="image/*,audio/*,video/*,.pdf,.doc,.docx,.txt" aria-label="–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª">
    </div>

    <div id="imagePreviewModal" class="modal hidden">
        <div class="modal-content">
            <button class="close-modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
            <img id="previewImage" src="" alt="–ü—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
        </div>
    </div>

    <div id="membersModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–£—á–∞—Å—Ç–Ω–∏–∫–∏</h3>
                <button class="close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
            </div>
            <div id="membersList" class="members-list"></div>
        </div>
    </div>

    <div id="chatSettingsModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞</h3>
                <button class="close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
            </div>
            <div class="settings-content">
                <div class="setting-item">
                    <label for="chatMessageTtl">–£–¥–∞–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑</label>
                    <select id="chatMessageTtl" name="chatMessageTtl" title="–í—Ä–µ–º—è —É–¥–∞–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π">
                        <option value="1">1 –¥–µ–Ω—å</option>
                        <option value="3">3 –¥–Ω—è</option>
                        <option value="7">7 –¥–Ω–µ–π</option>
                        <option value="30">30 –¥–Ω–µ–π</option>
                        <option value="0">–ù–∏–∫–æ–≥–¥–∞</option>
                    </select>
                </div>
                <button id="saveChatSettingsBtn" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="/js/api.js"></script>
    <script src="/js/chat.js"></script>
</body>
</html>